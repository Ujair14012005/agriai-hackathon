<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Crop Calendar - KrishiConnect</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="{{ url_for('static', filename='css/styles.css') }}" rel="stylesheet" />
</head>
<body>
<nav class="navbar navbar-light bg-white shadow-sm">
  <div class="container">
    <a class="navbar-brand fw-bold" href="{{ url_for('index') }}">ðŸŒ± KrishiConnect</a>
  </div>
</nav>

<div class="container mt-4">
  <h4>Crop Calendar</h4>
  <div class="table-responsive">
    <table class="table table-striped">
      <thead>
        <tr><th>Crop</th><th>Kharif</th><th>Rabi</th></tr>
      </thead>
      <tbody id="tbl"></tbody>
    </table>
  </div>
</div>

<script>
const fallback = [
  {crop:'Rice', kharif:'June - October', rabi:'Nov - Feb'},
  {crop:'Wheat', kharif:'-', rabi:'Nov - Apr'},
  {crop:'Maize', kharif:'June - Sep', rabi:'Oct - Feb'},
  {crop:'Banana', kharif:'Year-round', rabi:'Year-round'}
];

function renderCalendar(calendar){
  const t = document.getElementById('tbl');
  t.innerHTML = '';
  calendar.forEach(c => {
    const tr = document.createElement('tr');
    tr.innerHTML = `<td>${c.crop}</td><td>${c.kharif||c.k}</td><td>${c.rabi||c.r}</td>`;
    t.appendChild(tr);
  });
}

async function load(){
  try{
    const res = await fetch('{{ url_for("api_crop_calendar") }}');
    const j = await res.json();
    if(res.ok && j.ok && Array.isArray(j.calendar)){
      renderCalendar(j.calendar);
      return;
    }
  }catch(e){ console.warn('API fetch failed', e); }
  renderCalendar(fallback);
}

window.addEventListener('DOMContentLoaded', load);
</script>
</body>
</html>
